<p-dialog class="dialog" [header]="dialogTitle" [(visible)]="visible" [modal]="true"
          [style]="{maxHeight: '80vh',width: '50vw'}"
          (onHide)="closeDialog($event)">
    <form #f="ngForm" name="vacancy" novalidate>
        <div class="flex" [class.formDisabled]="loading">
            <!--            <div class="p-inputgroup">-->
            <!--                <span class="p-inputgroup-addon" style="width: 120px">Должность <span class="required-mark">*</span> </span>-->
            <!--                <p-dropdown [options]="positions"-->
            <!--                            appendTo="body"-->
            <!--                            [(ngModel)]="staffUnit.position"-->
            <!--                            (ngModelChange)="selectPosition()"-->
            <!--                            name="position"-->
            <!--                            [style]="{width: '100%'}"-->
            <!--                            [optionLabel]="'name'"></p-dropdown>-->
            <!--            </div>-->

            <div class="p-inputgroup">
                <span class="p-inputgroup-addon" style="width: 120px">HR</span>
                <p-dropdown [options]="employees"
                            appendTo="body"
                            [(ngModel)]="staffUnit.employee"
                            name="firstName"
                            [style]="{width: '100%'}"
                            [optionLabel]="'employeeFullName'"></p-dropdown>
            </div>

            <span class="fail" *ngIf="isInvalidSumWeight()"
                  style="color:red"> Общий вес должен быть равен {{this.competenceWeightMaxSum}}</span>

            <div class="personal-skills">

                <div class="personal-skills__toolbar">
                    <!--          <button pButton type="button" class="p-button-success" label="Добавить новый навык"-->
                    <!--                  icon="pi pi-cog"></button>-->
                    <span class="personal-skills__text">Общий вес: {{sum}}</span>
                </div>
                <div class="flex flex-wrap gap-3 info-block">
                    <div class="skills" *ngFor="let skill of item.competenceWeight">

                        <div class="skills__title">
                            <button pButton
                                    icon="pi pi-times"
                                    class="tiffany-button-secondary"
                                    [style]="{border: 'none !important'  }"
                                    (click)="deleteSkill(skill.competence.id)">
                            </button>
                            {{skill?.competence?.name}}
                        </div>
                        <div class="skills__weight">
                            <p-inputNumber [(ngModel)]="skill.weight" [min]=0
                                           [name]="'weight' + skill?.competence?.id" [required]=true
                                           [showButtons]="true"></p-inputNumber>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <p-footer>

        <p-button icon="pi pi-check"
                  (onClick)="onSubmit($event)"
                  [disabled]="!f.valid || isInvalidSumWeight()"
                  [label]="getSaveLabel()"
                  styleClass="tiffany-button">
        </p-button>
    </p-footer>
</p-dialog>
<p-sidebar [(visible)]="showSidebarWithAllSkills" *ngIf="showSidebarWithAllSkills" position="right">
    <div class="container">
        <h1>Список всех навыков</h1>
        <div class="main-block" *ngFor="let competenceGroup of competenceGroupsWithCompetences; let indexGroup = index">
            <div class="main-block__first">
                <div class="main-block__title">{{competenceGroup.competenceGroup.name}}</div>
                <!--                <div class="main-block__add">-->
                <!--                    <p-button-->
                <!--                            icon="pi pi-plus"-->
                <!--                            styleClass="tiffany-button "-->
                <!--                            (onClick)="pushNewSkill(index)">-->
                <!--                    </p-button>-->
                <!--                </div>-->
            </div>

            <div class="dop-info">
                <div class="dop-info__container" *ngFor="let competence of competenceGroup.competences; let index = index">
                    <div class="dop-info__title">
                        {{competence.name}}
                    </div>
                    <p-button
                            icon="pi pi-plus"
                            styleClass="tiffany-button "
                            (onClick)="pushNewSkill(competence.id, indexGroup)">
                    </p-button>
                </div>
            </div>
        </div>
    </div>
</p-sidebar>
