# Руководство администратора

Приложение *Atomic Hunter* состоит из клиентского веб—приложения и серверной части.
Веб-приложение разработано c помощью *Angular 15*.
Серверная часть представляет собой сервис, разработанный с помощью *Java 17* и фреймворка *Spring Boot 3*.

---

## Настройка Java-сервиса
Java-сервис конфигурируется с помощью .yml файлов. В папке содержатся:


* application.yml - основной конфигурационный файл
* application-pg.yml - конфигурация СУБД PostgreSQL
* application-h2.yml - конфигурация СУБД h2
* application-mail.yml - конфигурационный файл, включающий в себя настройки почты (для исходящих писем)

 Java-сервис по умолчанию c помощью JDBC подключается к  СУБД *PostgreSQL*.
 
 За выбор режима работы с соответствующей СУБД в конфигурационном файле `application.yml` есть следующая настройка: 
```
spring:
  profiles:
    active: pg,mail #для режима работы с H2 данная настройка должна принимать h2,mail
```
Вы можете отредактировать конкретные настройки подключения к СУБД в файле *application-pg.yml* в зависимости от выбранного режима profiles.active в *application.yml*.
По умолчанию мы предлагаем использование PostgreSQL в качестве СУБД. Перед запуском сервиса необходимо настроить файл `application-pg.yml`. Проверьте url, username, password.

```
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/postgres
    username: postgres
    password: postgres
```

По умолчанию сервис запускается на порту 8081.
Вы можете изменить порт запуска сервиса в `application.yml`.

## Настройка клиента
 Запуск веб-приложения Angular осуществляется с помощью nginx. Для запуска *nginx* достаточно запустить файл *nginx.exe*, который располагается в папке `nginx`. Согласно представленным конфигурационным файлам nginx запускает приложение на порту 4242.

 Файлы клиентского приложения располагаются в папке `nginx/html`. Внутри папки `frontend/nginx/html` располагаются ресурсы приложения и конфигурационный файл `config.json`. Внутри данного конфигурационного файла вы можете изменить адрес доступа к java-сервису:
 ```
  {
    "backendUrl": "http://localhost:8081"
  }
 ```
 
 Для более точной настройки клиентского приложения можно отредактировать файл `nginx.conf`.


## Импорт исторических данных
Настройки, отвечающие за импорт исторических данных выведены в `application.yml`.
Импорт исторических данных производится с конфигурируемой периодичностью. Данная настройка представлена в следующих параметрах:
```
scheduled:
  staff-units: "5000"
  employees: "5000"
  positions: "5000"
```
При запуске java-сервис начинает с заданной периодичностью опрашивать внешний сервис. 

Адрес внешнего окружения прописывается в следующей настройке:
```
remoteService:
  url: "http://172.30.9.31:5000"
```

## Первичный вход в приложение

В системе предусмотрена возможность создания пользователя-администратора для захода в приложение. Это конфигурируетя в файле `application.yml`.

```
default-user:
  login: "admin"
  password: "admin"
  email: "admin-user-42-user-admin@gmail.com"
  full-name: "Админ Админович Админов"
```

После открытия клиентского приложения в браузере в поле логин и пароль можно ввести данные учетной записи, указанные в настройках выше.